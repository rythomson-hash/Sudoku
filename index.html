<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NYT-Style Sudoku</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    background: #f7f7f7;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    padding: 20px;
  }
  #sudoku-container {
    display: grid;
    grid-template-columns: repeat(9, 60px);
    grid-template-rows: repeat(9, 60px);
    border: 4px solid #333;
    background: #333;
  }
  .cell {
    background: #fff;
    border: 1px solid #999;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: 24px;
    position: relative;
    cursor: pointer;
  }
  /* Bold box borders like NYT */
  .cell.border-bottom { border-bottom: 4px solid #333; }
  .cell.border-right { border-right: 4px solid #333; }
  .cell.fixed { color: #000; }
  .cell.selected { background: #ffd; }
  .cell.highlight { background: #d6f0ff; }
  .candidates {
    font-weight: normal;
    font-size: 10px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    justify-items: center;
    align-items: center;
    position: absolute;
    top: 2px; left: 2px; right: 2px; bottom: 2px;
    color: #555;
  }
  #controls {
    margin-top: 20px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  button {
    padding: 10px 15px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>NYT-Style Sudoku</h1>
<div id="sudoku-container"></div>
<div id="controls">
  <button id="pencil-toggle">Pencil Mode: OFF</button>
  <button id="clear-cell">Clear Cell</button>
  <button id="reset-board">Reset Board</button>
</div>

<script>
const container = document.getElementById('sudoku-container');
let pencilMode = false;
let selectedCell = null;

// Sample puzzle (0 = empty)
const puzzle = [
  [5,3,0,0,7,0,0,0,0],
  [6,0,0,1,9,5,0,0,0],
  [0,9,8,0,0,0,0,6,0],
  [8,0,0,0,6,0,0,0,3],
  [4,0,0,8,0,3,0,0,1],
  [7,0,0,0,2,0,0,0,6],
  [0,6,0,0,0,0,2,8,0],
  [0,0,0,4,1,9,0,0,5],
  [0,0,0,0,8,0,0,7,9]
];

let board = [];
function deepCopy(arr) { return arr.map(r => r.slice()); }

function createBoard() {
  container.innerHTML = '';
  board = deepCopy(puzzle);
  for(let row = 0; row < 9; row++){
    for(let col = 0; col < 9; col++){
      const cell = document.createElement('div');
      cell.classList.add('cell');
      if((row+1)%3===0 && row<8) cell.classList.add('border-bottom');
      if((col+1)%3===0 && col<8) cell.classList.add('border-right');
      cell.dataset.row = row;
      cell.dataset.col = col;
      container.appendChild(cell);

      if(board[row][col] !== 0){
        cell.textContent = board[row][col];
        cell.classList.add('fixed');
      } else {
        const candidates = document.createElement('div');
        candidates.classList.add('candidates');
        candidates.innerHTML = Array(9).fill('').map((_,i) => `<span>${i+1}</span>`).join('');
        cell.appendChild(candidates);
      }

      cell.addEventListener('click', () => selectCell(cell));
    }
  }
  updateCandidates();
}

function selectCell(cell){
  if(selectedCell) selectedCell.classList.remove('selected');
  selectedCell = cell;
  cell.classList.add('selected');
  highlightSameNumbers(cell.dataset.value);
}

function highlightSameNumbers(value){
  document.querySelectorAll('.cell').forEach(c => c.classList.remove('highlight'));
  if(!value) return;
  document.querySelectorAll('.cell').forEach(c => {
    if(c.dataset.value === value){
      c.classList.add('highlight');
    }
  });
}

function updateCandidates(){
  for(let row=0; row<9; row++){
    for(let col=0; col<9; col++){
      const cell = container.children[row*9+col];
      if(board[row][col]!==0) {
        cell.dataset.value = board[row][col];
        cell.textContent = board[row][col];
        cell.classList.add('fixed');
        if(cell.querySelector('.candidates')) cell.querySelector('.candidates').style.display='none';
      } else {
        const candidateDiv = cell.querySelector('.candidates');
        candidateDiv.style.display='grid';
        const taken = new Set();
        for(let i=0;i<9;i++){
          if(board[row][i]) taken.add(board[row][i]);
          if(board[i][col]) taken.add(board[i][col]);
        }
        const startRow = Math.floor(row/3)*3;
        const startCol = Math.floor(col/3)*3;
        for(let r=startRow;r<startRow+3;r++){
          for(let c=startCol;c<startCol+3;c++){
            if(board[r][c]) taken.add(board[r][c]);
          }
        }
        candidateDiv.querySelectorAll('span').forEach((s,i)=>{
          s.textContent = taken.has(i+1) ? '' : i+1;
        });
        cell.dataset.value = '';
        cell.textContent = '';
      }
    }
  }
}

document.addEventListener('keydown', (e) => {
  if(!selectedCell || selectedCell.classList.contains('fixed')) return;
  const row = +selectedCell.dataset.row;
  const col = +selectedCell.dataset.col;

  if(e.key >= '1' && e.key <= '9'){
    if(pencilMode){
      const candidateDiv = selectedCell.querySelector('.candidates');
      const span = candidateDiv.children[+e.key-1];
      span.textContent = span.textContent === e.key ? '' : e.key;
    } else {
      board[row][col] = +e.key;
      updateCandidates();
      highlightSameNumbers(e.key);
    }
  }
  if(e.key === 'Backspace' || e.key === 'Delete'){
    board[row][col] = 0;
    updateCandidates();
  }
});

document.getElementById('pencil-toggle').addEventListener('click', () => {
  pencilMode = !pencilMode;
  document.getElementById('pencil-toggle').textContent = `Pencil Mode: ${pencilMode?'ON':'OFF'}`;
});

document.getElementById('clear-cell').addEventListener('click', () => {
  if(selectedCell && !selectedCell.classList.contains('fixed')){
    const row = +selectedCell.dataset.row;
    const col = +selectedCell.dataset.col;
    board[row][col] = 0;
    updateCandidates();
  }
});

document.getElementById('reset-board').addEventListener('click', () => {
  createBoard();
});

createBoard();
</script>

</body>
</html>
